<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>Budget Status â€“ Budget Bot</title>
  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.4.3/dist/css/bootstrap.min.css" rel="stylesheet">
  <link href="assets/style.css" rel="stylesheet">
</head>
<body>
  <!-- Sticky header with back button -->
  <header class="navbar">
    <div class="container d-flex align-items-center">
      <button class="btn-back" onclick="location.href='index.html'">&larr;</button>
      <span class="nav-title">Budget Status</span>
    </div>
  </header>

  <div class="container mt-4" style="max-width:360px;">
    <div class="card p-3">
      <div id="budgetList" class="list-group list-group-flush"></div>
    </div>
  </div>

  <script>
    const API = 'http://127.0.0.1:8000';

    async function loadBudget() {
      const res = await fetch(`${API}/budget/`);
      const list = document.getElementById('budgetList');

      if (!res.ok) {
        const err = await res.json();
        list.innerHTML = `<div class="list-group-item text-danger">${err.detail}</div>`;
        return;
      }

      const data = await res.json();
      list.innerHTML = '';

      data.budget.forEach(item => {
        const remD = `$${(item.remaining_cents/100).toFixed(2)}`;
        const initD = `$${(item.initial_cents/100).toFixed(2)}`;
        const pct  = item.percent_left.toFixed(0);

        const el = document.createElement('div');
        el.className = 'list-group-item';
        el.innerHTML = `
          <div class="d-flex justify-content-between mb-2">
            <div>${item.category}</div>
            <div>${remD} / ${initD}</div>
          </div>
          <div class="progress">
            <div class="progress-bar" role="progressbar"
                 style="width: ${pct}%"
                 aria-valuenow="${pct}" aria-valuemin="0" aria-valuemax="100">
              ${pct}%
            </div>
          </div>
        `;
        list.appendChild(el);
      });
    }

    loadBudget();
  </script>
</body>
</html>
